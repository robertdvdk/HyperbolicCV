program: code/classification/train.py
method: bayes
metric:
  name: val/acc@1
  goal: maximize
parameters:

  mlr:
    values: [ours, theirs]
  mlr_std_mult:
    distribution: log_uniform_values
    min: 0.25
    max: 4.0
  weight_decay:
    distribution: log_uniform_values
    min: 1e-5
    max: 5e-3
  lr:
    distribution: log_uniform_values
    min: 1e-2
    max: 2e-1

  init_method:
    values: [eye, kaiming, lorentz_kaiming]
  batchnorm:
    values: [euclidean, manifold]


  compile:
    value: true
  output_dir:
    value: classification/output
  device:
    value: cuda:0
  dtype:
    value: float32
  seed:
    value: 1
  num_epochs:
    value: 200
  batch_size:
    value: 128
  optimizer:
    value: RiemannianSGD
  lr_scheduler:
    value: step
  warmup_epochs:
    value: 10
  batch_size_test:
    value: 128
  num_layers:
    value: 18
  embedding_dim:
    value: 512
  encoder_manifold:
    value: lorentz
  decoder_manifold:
    value: lorentz
  learn_k:
    value: false
  encoder_k:
    value: 1.0
  decoder_k:
    value: 1.0
  clip_features:
    value: 1.0
  dataset:
    value: CIFAR-100
  train_subset_fraction:
    value: 1.0
  val_fraction:
    value: 0.1
  linear_method:
    value: ours
